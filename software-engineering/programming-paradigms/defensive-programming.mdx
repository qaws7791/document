---
title: 방어적 프로그래밍
description: 방어적 프로그래밍은 프로그램이 잘못된 입력이나 상태에도 안정적으로 동작할 수 있도록 하는 프로그래밍 기법입니다.
---

코드 컴플리트 - 8장에서 다룸

클린 코드 7,8 장에서 에러를 다룸

- 컴파일 타임의 유효성 검사
- 불변 변수 사용
- 접근 제어자를 통한 범위 제한
- 정적 타입 검사기를 활용한 버그 식별
  - 적절하고 구체적인 타입을 사용하는 것이 중요
- 회복성 있는 코드 작성


## null 값 사용을 지양하기

-함수의 시작부분에서 널을 체크하여 아래 코드에서는 안전하게 사용하기


## 입력 값을 믿지 마라

사전 조건 및 사후 조건

체크섬(네트워크와 스토리지를 믿지마라)

데이터 유효성 검사

보안 기법, 에러 탐지 도구 등

원하지 않는 입력값이 들어오면 최대한 빠르게 중단

- 문자열인가 숫자인가?
- 문자열이라면 원하는 형식의 문자열인가?(앞, 뒤, 단어 사이 공백 처리 포함)
- 이메일, 전화번호, ip주소 등 정해진 형식에 부합하는가?(정규식 활용)
- 숫자라면 원하는 범위의 숫자인가?
- 배열이라면 원하는 원소로 구성되었거나 원하는 길이의 배열인가?
- 날짜라면 어떤 날짜 형식을 사용하는가?


## 예외는 언어에서 지원하는 표준 에러 처리 패턴을 활용하라

에러 대신 특정 값 0, -1과 같은 것을 반환하는 것은 위험하다

예외는 이러한 값보다 더 많은 것을 표현할 수 있다

> 예외는 일찍 던지고 최대한 나중에 처리하라 - 예외인 걸 알았을 때 가능한 빨리 예외를 던지고, 적절한 위치에 도달할 때까지 호출 스택으로 전파하라

재시도 전략

백오프(backoff) 전략 - 비선형으로 대기 시간을 늘리는 방법

지터(jitter) - 천둥떼 현상을 피하기 위해 추가하는 임의의 지연 시간으로 재시도 작업이 몰리지 않도록 해준다

빨리 실패하기 - 예상하지 못한 에러가 발생했을 때 피해를 줄이기 위해 빨리 실패하는 것이 나을 수 있다

시스템에 멱등성을 적용하여 같은 재시도를 효울적으로 처리할 수 있다

리소스 해제 - 에러 발생 시 더 이상 사용하지 않는 리소스를 해체하여 낭비를 줄일 수 있다

로깅

로깅 레벨 적용 - 필요한 수준의 로그만 기록할 수 있다

로깅에 개인정보와 같은 민감한 데이터를 넣으면 안된다
